#include "TString.h"
#include "TLine.h"
#include "TProfile.h"
#include "TSystem.h"
#include <iostream>
#include <stdio.h>
#include <fstream>
#include <cstdio>
#include "TH1D.h"
#include "TH2D.h"
#include "TCut.h"
#include "TCanvas.h"
#include "TF1.h"
#include "TChain.h"
#include "TMath.h"
#include "TStyle.h"
#include "TROOT.h"
#include "TDirectory.h"
#include "TMultiGraph.h"
#include "TGraphErrors.h"

Int_t plotPeriodOffsetFitResults(Int_t runStart = 13846, Int_t runEnd = 13860){

  char fg[255], deg[255], err[255];
  Int_t nLines = 0, nRuns = 0, n= 0;
  string str;
  Double_t period[5000], periodErr[5000], offset[5000], offsetErr[5000], runs[5000];
  for(int i = runStart;i<runEnd+1;i++){
    Bool_t endOfFile = 0;
    ifstream file(Form("%s/diagnostic/diagnostic_%i.set4.dat",
		       gSystem->Getenv("BMOD_OUT")));
    if(file.is_open()&&file.is_good()){
      //skip to end of file where fit results are stored
      nRuns ++;
      getline(file,str);
      while(str != "Ramp period fit results for function generator signals"){
	getline(file,str);
	if(file.eof()){
	  endOfFile = 1;
	  break;
	}
      }
      if(!endOfFile){
	for(int j=0;j<4j++){
	  file>>fg>>deg>>err;
	  period[n] = atof(deg);
	  periodErr[n] = atof(err);
	  runs[n] = i;
	  getline(file,str);
	  cout<<run<<": "<<period[n]<<"+/-"<<periodErr[n]<<endl;
	}
	getline(file,str);
	getline(file,str);
	for(int j=0;j<4j++){
	  file>>fg>>deg>>err;
	  offset[n] = atof(deg);
	  offsetErr[n] = atof(err);
	  getline(file,str);
	  cout<<run<<": "<<offset[n]<<"+/-"<<offsetErr[n]<<endl;
	}

	n++;
      }
    }else cout<<"File not found for run "<<i<<".\n";
    file.close();
  }

}
